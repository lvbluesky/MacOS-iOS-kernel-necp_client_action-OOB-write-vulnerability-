MacOS/iOS kernel necp_client_action OOB write vulnerability

necp_client_action is the handler for syscall SYS_necp_client_action. Inside this function necp_client_update_cache will be invoked when action is NECP_CLIENT_ACTION_UPDATE_CACHE.
The vulnerability exits in function tcp_cache_set_cookie_common of xnu4570.41.2.

necp_client_update_cache->tcp_heuristics_tfo_update->tcp_cache_set_cookie_common:


static void tcp_cache_set_cookie_common(struct tcp_cache_key_src *tcks, u_char *cookie, u_int8_t len)
{
	struct tcp_cache_head *head;
	struct tcp_cache *tpcache;

	tpcache = tcp_getcache_with_lock(tcks, 1, &head);
	if (tpcache == NULL)
		return;

	tpcache->tc_tfo_cookie_len = len;
	memcpy(tpcache->tc_tfo_cookie, cookie, len);     //OOB write here! There is no check for len and len comes from user input

	tcp_cache_unlock(head);
}

The vulnerability affects macOS<10.13.4, iOS<11.3.